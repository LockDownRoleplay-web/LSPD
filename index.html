<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>LSPD PD-System ‚Äì Leitstelle ¬∑ Strafkatalog ¬∑ Personal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- LOGIN SCREEN -->
<div id="login-screen" class="login-screen">
  <div class="login-card">
    <div class="login-header">
      <div class="login-badge">LSPD ¬∑ SECURE</div>
      <h1>Police Dispatch</h1>
    </div>

    <div class="login-body">
      <label for="login-user">E-Mail</label>
      <input
        id="login-user"
        type="text"
        autocomplete="username"
        placeholder="z. B. Max@lbscripts.com"
      />

      <label for="login-pass">Passwort</label>
      <input
        id="login-pass"
        type="password"
        autocomplete="current-password"
        placeholder="Passwort"
      />

      <button id="login-btn" class="btn btn-primary btn-full">
        <span class="btn-icon">üîê</span>
        Anmelden
      </button>

      <div id="login-error" class="login-error" style="display:none;">
        Login fehlgeschlagen. Bitte √ºberpr√ºfe E-Mail und Passwort.
      </div>
    </div>
  </div>
</div>



  <!-- APP WRAPPER -->
  <div class="app" id="app-root">
    <!-- TOP BAR -->
    <header class="topbar">
      <div class="topbar-left">
        <img src="img/lspd_logo.png" alt="LSPD Logo" class="topbar-logo">

       <div class="topbar-text">
       <div class="topbar-title">LSPD ¬∑ Tactical Operations Center</div>
       <div class="topbar-subtitle">Leitstelle ¬∑ Strafkatalog ¬∑ Personal</div>
     </div>
    </div>

      <div class="topbar-right">
        <div class="topbar-status">
          <span class="status-dot status-dot-green"></span>
          Dispatch online
        </div>
        <div class="topbar-user">
          <div class="user-label">
            Eingeloggt als <span id="current-user-label"></span>
          </div>
          <div class="user-actions">
            <button id="logout-btn" class="btn btn-ghost btn-xs" style="display:none">
              <span class="btn-icon">‚èè</span>
              Logout
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- NAVIGATION -->
    <nav class="nav-main">
      <button class="nav-item nav-item-active" data-target="view-leitstelle">
        <span class="nav-icon">üìã</span>
        <span>Leitstellenblatt</span>
      </button>
      <button class="nav-item" data-target="view-strafkatalog">
        <span class="nav-icon">‚öñÔ∏è</span>
        <span>Strafkatalog</span>
      </button>
      <button class="nav-item" data-target="view-personal">
        <span class="nav-icon">üßë‚Äç‚úàÔ∏è</span>
        <span>Personalabteilung</span>
      </button>
    </nav>

    <!-- CONTENT -->
    <main class="main">
      <!-- LEITSTELLENBLATT -->
      <section id="view-leitstelle" class="view view-active">
  <div class="grid-2">

    <!-- PANEL 1 ‚Äì Leitstellenblatt -->
    <div class="panel">
      <div class="panel-header">
        <div>
          <div class="panel-title">Leitstellenblatt</div>
          <div class="panel-subtitle">Einsatz√ºbersicht ¬∑ Funkdisposition</div>
        </div>
        <div class="panel-tag danger-soft">SHIFT ACTIVE</div>
      </div>

      <div class="panel-body">

        <div class="form-row">
          <div class="field">
            <label for="leit-leiter">Supervisor</label>
            <input id="leit-leiter" type="text" placeholder="DN + Name" />
          </div>

          <div class="field">
            <label for="leit-disponent">Leitstelle</label>
            <input id="leit-disponent" type="text" placeholder="DN + Name" />
          </div>
        </div>

        <div class="field">
          <label for="leit-notizen">Lage / Hinweise</label>
          <textarea id="leit-notizen" rows="4" placeholder="Kurzlage, Fahndungen, Sonderlagen ‚Ä¶"></textarea>
        </div>

      </div>
    </div>

    <!-- PANEL 2 ‚Äì Eingeteilte Einheiten -->
<div class="panel">
    <div class="panel-header">
        <div>
            <div class="panel-title">Eingeteilte Einheiten</div>
            <div class="panel-subtitle">Rufnamen ¬∑ Funk ¬∑ Status</div>
        </div>
    </div>

    <div class="panel-body">
        <div class="table-wrapper">
            <table class="table">
                <thead>
                    <tr>
                        <th>ADAM/LINCOLN</th>
                        <th>Nr.</th>
                        <th>DN + Name</th>
                        <th>Funker</th>
                        <th>Status</th>
                    </tr>
                </thead>

                <tbody id="leit-tbody">
                    <!-- JS f√ºllt automatisch -->
                </tbody>
            </table>
        </div>

        <div class="btn-row-right">
            <button id="leit-add-row" class="btn btn-ghost btn-sm">‚ûï Zeile</button>
            <button id="leit-clear-rows" class="btn btn-ghost btn-sm">üßπ Tabelle leeren</button>
        </div>

        <div class="btn-row-right mt-8">
            <button id="leit-copy" class="btn btn-primary">
                üìã Leitstellenblatt kopieren
            </button>
            <button id="leit-reset" class="btn btn-ghost">
                ‚ü≤ Formular zur√ºcksetzen
            </button>
        </div>
    </div>
</div>
</section>

      <!-- STRAFKATALOG -->
      <section id="view-strafkatalog" class="view">
        <!-- LOCK BANNER -->
        <div id="straf-lock-banner" class="lock-banner lock-banner-hidden">
          <div class="lock-banner-left">
            <span class="lock-icon">‚ö†Ô∏è</span>
            <div>
              <div class="lock-title">Strafkatalog gesperrt</div>
              <div class="lock-text">
                Aktive Bearbeitung durch: <span id="straf-lock-user"></span>
              </div>
            </div>
          </div>
          <div class="lock-banner-right">
            <div class="lock-timer">
              Timeout in <span id="straf-lock-countdown">--</span>s
            </div>
            <button id="straf-release-own" class="btn btn-ghost btn-xs">
              üîì Eigene Bearbeitung beenden
            </button>
          </div>
        </div>

        <div class="grid-2">
          <div class="panel">
            <div class="panel-header">
              <div>
                <div class="panel-title">Strafkatalog</div>
                <div class="panel-subtitle">Delikte ausw√§hlen ¬∑ Betr√§ge & Haftzeit</div>
              </div>
              <div class="panel-tag danger-soft">LOCK MODE B2</div>
            </div>
            <div class="section-label">Kategorien</div>
              <div id="straf-categories" class="chip-row">
                <!-- per JS -->
              </div>

              <div class="section-label mt-12">Delikte</div>
              <div id="straf-list" class="offence-list">
                <!-- per JS -->
              </div>
            </div>
          </div>

          <div class="panel panel-accent">
            <div class="panel-header">
              <div>
                <div class="panel-title">Zusammenfassung</div>
                <div class="panel-subtitle">Ausgew√§hlte Straftaten</div>
              </div>
              <div class="panel-tag success-soft">TICKET SUMMARY</div>
            </div>

            <div class="panel-body">
              <div class="metric-row">
                <div class="metric-box">
                  <div class="metric-label">Anzahl Delikte</div>
                  <div id="metric-count" class="metric-value">0</div>
                </div>
                <div class="metric-box">
                  <div class="metric-label">Gesamtstrafe</div>
                  <div id="metric-money" class="metric-value">0 $</div>
                </div>
                <div class="metric-box">
                  <div class="metric-label">Gesamt-Haftzeit</div>
                  <div id="metric-jail" class="metric-value">0 Min.</div>
                </div>
              </div>

              <div class="section-label mt-12">Deliktliste</div>
              <div id="straf-summary-list" class="summary-list">
                <div class="summary-empty">
                  Noch keine Delikte hinzugef√ºgt. W√§hle links eine Kategorie und f√ºge Straftaten hinzu.
                </div>
              </div>

              <div class="btn-row-right mt-8">
                <button id="straf-copy" class="btn btn-primary btn-sm">
                  üìã Zusammenfassung kopieren
                </button>
                <button id="straf-clear" class="btn btn-danger btn-sm">
                  üßπ Auswahl l√∂schen
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- PERSONAL -->
      <section id="view-personal" class="view">
        <div class="grid-2">
          <div class="panel">
            <div class="panel-header">
              <div>
                <div class="panel-title">Personalabteilung</div>
                <div class="panel-subtitle">LSPD-Mitarbeiter verwalten</div>
              </div>
              <div class="panel-tag neutral-soft">PERSONNEL</div>
            </div>

            <div class="panel-body">
              <div class="form-row">
                <div class="field">
                  <label for="p-name">Name</label>
                  <input id="p-name" type="text" placeholder="Vor- und Nachname" />
                </div>
                <div class="field">
                  <label for="p-id">Dienstnummer</label>
                  <input id="p-id" type="text" placeholder="z. B. 2031" />
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="p-rank">Rang</label>
                  <select id="p-rank">
                    <option value="">Bitte w√§hlen ‚Ä¶</option>
                    <option>Cadet</option>
                    <option>Officer</option>
                    <option>Senior Officer</option>
                    <option>Corporal</option>
                    <option>Sergeant</option>
                    <option>Staff Sergeant</option>
                    <option>Lieutenant</option>
                    <option>Captain</option>
                    <option>Deputy Chief</option>
                    <option>Assistant Chief</option>
                    <option>Chief of Police</option>
                  </select>
                </div>
                <div class="field">
                  <label for="p-dept">Abteilung</label>
                  <select id="p-dept">
                    <option value="">Bitte w√§hlen ‚Ä¶</option>
                    <option>Patrol Division</option>
                    <option>Traffic Division</option>
                    <option>Detective Bureau</option>
                    <option>SWAT</option>
                    <option>Air Support</option>
                    <option>Training / FTO</option>
                    <option>Internal Affairs</option>
                    <option>Command Staff</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="p-status">Status</label>
                  <select id="p-status">
                    <option>Aktiv</option>
                    <option>In Ausbildung</option>
                    <option>Beurlaubt</option>
                    <option>Suspendiert</option>
                    <option>Ausgeschieden</option>
                  </select>
                </div>
                <div class="field">
                  <label for="p-gear">Ger√§te / Zuweisung</label>
                  <input id="p-gear" type="text" placeholder="Bodycam 12, Car 23, Funk 5" />
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="p-quals">Qualifikationen</label>
                  <input id="p-quals" type="text" placeholder="FTO, Air Support, SWAT ‚Ä¶" />
                </div>
                <div class="field">
                  <label for="p-notes">Notizen</label>
                  <input id="p-notes" type="text" placeholder="Interne Hinweise ‚Ä¶" />
                </div>
              </div>

              <input type="hidden" id="p-edit-index" value="-1" />

              <div class="btn-row-right mt-8">
                <button id="p-save" class="btn btn-primary">
                  üíæ Speichern / Aktualisieren
                </button>
                <button id="p-reset" class="btn btn-ghost">
                  ‚Ü∫ Formular leeren
                </button>
              </div>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <div>
                <div class="panel-title">Mitarbeiter-Liste</div>
                <div class="panel-subtitle">Such- und Filterfunktion</div>
              </div>
              <div class="panel-tag neutral-soft">ROSTER</div>
            </div>

            <div class="panel-body">
              <div class="form-row align-center">
                <input
                  id="p-search"
                  class="search-input"
                  type="text"
                  placeholder="Suche nach Name, Dienstnr., Rang, Abteilung ‚Ä¶"
                />
                <button id="p-search-clear" class="btn btn-ghost btn-xs">‚úï</button>
              </div>

              <div class="table-wrapper mt-12">
                <table class="table table-compact">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Dienstnr.</th>
                      <th>Rang</th>
                      <th>Abteilung</th>
                      <th>Status</th>
                      <th>Aktion</th>
                    </tr>
                  </thead>
                  <tbody id="p-tbody">
                    <!-- per JS -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- USER ADMIN (nur Admin sichtbar) -->
        <div class="panel panel-wide admin-only mt-16">
          <div class="panel-header">
            <div>
              <div class="panel-title">Benutzerverwaltung</div>
              <div class="panel-subtitle">Zugang zum System steuern</div>
            </div>
            <div class="panel-tag danger-soft">ADMIN ONLY</div>
          </div>

          <div class="panel-body">
            <div class="form-row">
              <div class="field">
                <label for="u-name">Benutzername</label>
                <input id="u-name" type="text" placeholder="z. B. Dispatcher_01" />
              </div>
              <div class="field">
                <label for="u-pass">Passwort</label>
                <input id="u-pass" type="text" placeholder="Passwort" />
              </div>
              <div class="field">
                <label for="u-role">Rolle</label>
                <select id="u-role">
                  <option value="user">Standard (User)</option>
                  <option value="admin">Admin (voller Zugriff)</option>
                </select>
              </div>
            </div>

            <div class="btn-row-right mt-8">
              <button id="u-add" class="btn btn-primary btn-sm">
                ‚ûï Benutzer anlegen
              </button>
            </div>

            <div class="table-wrapper mt-12">
              <table class="table table-compact">
                <thead>
                  <tr>
                    <th>Benutzername</th>
                    <th>Rolle</th>
                    <th>Aktion</th>
                  </tr>
                </thead>
                <tbody id="u-tbody">
                  <!-- per JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- TOAST -->
  <div id="toast" class="toast toast-hidden">
    <span id="toast-icon" class="toast-icon">‚úÖ</span>
    <span id="toast-text">Aktion erfolgreich</span>
  </div>

   <!-- SCRIPTS -->
  <script src="js/leitstelle.js"></script>
  <script src="js/strafkatalog.js"></script>
  <script src="js/personal.js"></script>
  <script src="js/users.js"></script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, getDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// üî• Deine neue funktionierende Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyA8byjW0_CCpQUOcKEFl48cloZcaCJuH1g",
  authDomain: "lspd-dispatch-254cc.firebaseapp.com",
  projectId: "lspd-dispatch-254cc",
  storageBucket: "lspd-dispatch-254cc.firebasestorage.app",
  messagingSenderId: "940183514494",
  appId: "1:940183514494:web:50e98fc055dd968510972f"
};

// Firebase initialisieren
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Globale Exporte f√ºr app.js
window.auth = auth;
window.db = db;
window.signInWithEmailAndPassword = signInWithEmailAndPassword;
window.fsGetDoc = getDoc;
window.fsDoc = doc;
</script>
<script src="js/app.js"></script>
</body>
</html>

